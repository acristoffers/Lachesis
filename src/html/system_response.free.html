<div flex id="system-response-free">
    <div>
        <div id="free-graph"></div>
    </div>
    <div stretch default-padding>
        <h2>{{ 'Curve data' | translate }}</h2>

        <div default-padding>
            <mat-tab-group>
                <mat-tab [label]="'Data Points' | translate">
                    <table class="width-100" fixed>
                        <tbody>
                            <tr *ngFor="let point of test.points" inline-form flex>
                                <td width-33>
                                    <mat-form-field class="width-100">
                                        <input matInput [placeholder]="'Time (seconds)' | translate" [(ngModel)]="point.x" (blur)="plotPoints()" type="number">
                                    </mat-form-field>
                                </td>
                                <td width-33>
                                    <mat-form-field class="width-100">
                                        <input matInput [placeholder]="'Value' | translate" [(ngModel)]="point.y" (blur)="plotPoints()" type="number">
                                    </mat-form-field>
                                </td>
                                <td width-33>
                                    <button mat-raised-button color="warn" (click)="removePoint(point)">{{ 'Remove' | translate }}</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <button mat-raised-button color="secondary" (click)="addPoint()">{{ 'Add' | translate }}</button>
                    <br>
                    <br>
                </mat-tab>
                <mat-tab [label]="'Import' | translate">
                    <div>{{ 'Supported formats: CSV and JSON' | translate }}</div>
                    <div>{{ 'JSON: [{"x": 0, "y": 0}, {"x": 1, "y": 1}]' }}</div>
                    <div>{{ csvText | translate }}</div>
                    <br>
                    <br>
                    <mat-form-field id="import-area">
                        <textarea matInput [(ngModel)]="importText" placeholder="CSV/JSON"></textarea>
                    </mat-form-field>
                    <br>
                    <button mat-raised-button color="secondary" (click)="importData()">{{ 'Import' | translate }}</button>
                    <br>
                    <br>
                </mat-tab>
            </mat-tab-group>
        </div>

        <h2>{{ 'Input/Output Configuration' | translate }}</h2>

        <h3>{{ 'Output to control' | translate }}</h3>
        <div default-padding>
            <mat-select placeholder="{{ 'Output' | translate }}" class="width-100" [(ngModel)]="test.output">
                <mat-option *ngFor="let output of outputs" [value]="output">
                    {{ output }}
                </mat-option>
            </mat-select>
        </div>

        <h3>{{ 'Inputs to log' | translate }}</h3>
        <div default-padding>
            <div *ngFor="let input of inputs" class="input">
                <mat-checkbox [(ngModel)]="input[1]" (change)="updateInputs()">{{ input[0] }}</mat-checkbox>
            </div>
        </div>

        <h3>{{ 'Log Rate' | translate }}</h3>
        <div default-padding>
            <mat-form-field class="width-100">
                <input matInput [placeholder]="'Log Rate (seconds)' | translate" [(ngModel)]="test.logRate" type="number">
            </mat-form-field>
        </div>

        <h3>{{ 'Fixed outputs' | translate }}</h3>
        <div default-padding>
            <table class="width-100" fixed>
                <tbody>
                    <tr *ngFor="let output of test.fixedOutputs" inline-form>
                        <td width-60>
                            <mat-select placeholder="{{ 'Output' | translate }}" class="width-100" [(ngModel)]="output.alias">
                                <mat-option *ngFor="let out of outputs" [value]="out">
                                    {{ out }}
                                </mat-option>
                            </mat-select>
                        </td>
                        <td width-15>
                            <mat-form-field class="width-100">
                                <input matInput [placeholder]="'Value' | translate" [(ngModel)]="output.value" type="number">
                            </mat-form-field>
                        </td>
                        <td width-15>
                            <button mat-raised-button color="warn" (click)="removeFixedOutput(output)">{{ 'Remove' | translate }}</button>
                        </td>
                    </tr>
                </tbody>
            </table>
            <button mat-raised-button color="secondary" (click)="addFixedOutput()">{{ 'Add' | translate }}</button>
        </div>

        <h3>{{ 'After test outputs' | translate }}</h3>
        <div default-padding>
            <table class="width-100" fixed>
                <tbody>
                    <tr *ngFor="let output of test.afterOutputs" inline-form>
                        <td width-60>
                            <mat-select placeholder="{{ 'Output' | translate }}" class="width-100" [(ngModel)]="output.alias">
                                <mat-option *ngFor="let out of outputs" [value]="out">
                                    {{ out }}
                                </mat-option>
                            </mat-select>
                        </td>
                        <td width-15>
                            <mat-form-field class="width-100">
                                <input matInput [placeholder]="'Value' | translate" [(ngModel)]="output.value" type="number">
                            </mat-form-field>
                        </td>
                        <td width-15>
                            <button mat-raised-button color="warn" (click)="removeAfterOutput(output)">{{ 'Remove' | translate }}</button>
                        </td>
                    </tr>
                </tbody>
            </table>
            <button mat-raised-button color="secondary" (click)="addAfterOutput()">{{ 'Add' | translate }}</button>
        </div>
    </div>
</div>
